/**
 * Ultra-High Performance Video CSS
 * Seamless Poster-to-Video Transitions
 * 2025 Best Practices for Premium Brand Feel
 */

/* Core Video Container Structure */
.video-bg {
    position: relative;
    overflow: hidden;
    contain: layout style paint;
    transform: translateZ(0); /* GPU layer promotion */
    min-height: 300px; /* Ensure minimum height */
}

/* Hero video specific sizing */
.video-bg.priority-0 {
    min-height: 400px; /* Larger size for hero video */
}

/* Poster and Video Base Styles */
.video-poster,
.lazy-video {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    transition: opacity 0.5s ease-in-out;
    opacity: 0;
    image-rendering: high-quality;
    image-rendering: -webkit-optimize-contrast;
    backface-visibility: hidden;
    transform: translate3d(0,0,0);
    filter: none;
}

/* Poster-Specific Optimizations */
.video-poster {
    z-index: 2;
    opacity: 1;
    transition: opacity 0.4s cubic-bezier(0.4, 0.0, 0.2, 1);
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
    will-change: opacity;
    filter: none;
}

/* Video-Specific Optimizations */
.lazy-video {
    z-index: 1;
    opacity: 0;
    transition: opacity 0.5s cubic-bezier(0.4, 0.0, 0.2, 1);
    will-change: opacity, transform;
    
    /* Hardware acceleration */
    transform: translateZ(0);
    perspective: 1000px;
    
    /* Optimize rendering */
    image-rendering: optimizeSpeed;
    image-rendering: -webkit-optimize-contrast;
}

/* Playing State - Seamless Transition */
.lazy-video.playing {
    opacity: 1;
}

.lazy-video.playing + .video-poster,
.lazy-video.playing ~ .video-poster {
    opacity: 0;
}

/* Loading States with Smooth Progression */
.lazy-video:not(.playing) {
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #f8fafc 100%);
    background-size: 200% 200%;
    animation: shimmerLoad 2s ease-in-out infinite;
}

@keyframes shimmerLoad {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* Priority-Based Loading Optimizations */
.video-bg.priority-0 .lazy-video {
    /* Hero video - highest priority */
    will-change: transform, opacity, filter;
    transform: translateZ(0) scale(1);
}

.video-bg.priority-0 .video-poster {
    /* Hero poster - preload optimized */
    image-rendering: -webkit-optimize-contrast;
    image-rendering: optimize-contrast;
}

.video-bg.priority-1 .lazy-video,
.video-bg.priority-2 .lazy-video,
.video-bg.priority-3 .lazy-video {
    /* Lower priority videos - conservative resources */
    will-change: opacity;
    transform: translateZ(0);
}

/* Responsive Optimizations */
@media (max-width: 768px) {
    .lazy-video {
        /* Mobile optimizations */
        image-rendering: optimizeSpeed;
        max-width: 100vw;
        max-height: 60vh;
    }
    
    .video-poster {
        /* Faster transitions on mobile */
        transition: opacity 0.2s ease;
    }
    
    .lazy-video.playing {
        transition: opacity 0.3s ease;
    }
}

@media (max-width: 480px) {
    .lazy-video {
        /* Low-end device optimizations */
        will-change: auto;
        transform: none;
        transition: opacity 0.1s ease;
    }
    
    .video-bg {
        /* Reduce container complexity */
        contain: layout;
    }
}

/* High DPI Display Optimizations */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    .video-poster {
        image-rendering: -webkit-optimize-contrast;
        image-rendering: crisp-edges;
    }
}

/* Reduced Motion Accessibility */
@media (prefers-reduced-motion: reduce) {
    .video-poster,
    .lazy-video {
        transition: opacity 0.1s ease !important;
        animation: none !important;
    }
    
    .lazy-video:not(.playing) {
        background: #f1f5f9 !important;
        animation: none !important;
    }
}

/* Performance Monitoring Classes */
.lazy-video.quarter-buffered {
    /* 25% buffered - slight quality improvement */
    filter: brightness(1.02);
}

.lazy-video.half-buffered {
    /* 50% buffered - better quality */
    filter: brightness(1.05) contrast(1.02);
}

.lazy-video.well-buffered {
    /* 75%+ buffered - full quality */
    filter: brightness(1.08) contrast(1.05);
    transform: translateZ(0) scale(1.001); /* Subtle enhancement */
}

/* Container Hover Effects (Optional Premium Touch) */
.video-bg:hover .lazy-video.playing {
    transform: translateZ(0) scale(1.02);
    transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1), opacity 0.5s cubic-bezier(0.4, 0.0, 0.2, 1);
}

/* Error State Handling */
.video-bg.error .video-poster {
    opacity: 1 !important;
    filter: brightness(0.95) contrast(1.1);
}

.video-bg.error .lazy-video {
    opacity: 0 !important;
}

/* Preload Optimization Classes */
.video-poster[loading="eager"] {
    /* Critical posters load immediately */
    content-visibility: visible;
}

.video-poster[loading="lazy"] {
    /* Non-critical posters load when needed */
    content-visibility: auto;
    contain-intrinsic-size: 800px 450px;
}

/* Advanced GPU Optimizations */
.video-bg,
.video-poster,
.lazy-video {
    /* Optimize for mobile devices */
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000px;
    perspective: 1000px;
}

/* Wave Animation Fixes */
.wave-divider {
    position: relative;
    z-index: 5;
    display: block !important;
}

.wave-divider svg {
    display: block !important;
    animation-play-state: running !important;
}

.wave-divider svg path {
    display: block !important;
    animation-play-state: running !important;
    opacity: inherit !important;
}

/* Ensure waves are visible */
.fill-white {
    fill: white !important;
}

/* Fix video card grid layout - Larger sizes */
.grid.grid-cols-2.gap-6 {
    max-width: 600px; /* Increased from 400px */
    margin: 0 auto; /* Center the grid */
}

.grid.grid-cols-2.gap-6 > div {
    max-width: 280px; /* Increased from 180px */
}

.grid.grid-cols-2.gap-6 .video-bg {
    width: 100%;
    height: auto;
    aspect-ratio: 16/9;
    max-height: 180px; /* Increased from 120px */
}

/* Memory Management Classes */
.lazy-video.memory-optimized {
    /* For low-memory devices */
    max-width: 720px;
    max-height: 480px;
    image-rendering: optimizeSpeed;
}

.lazy-video.high-performance {
    /* For high-end devices */
    max-width: 1920px;
    max-height: 1080px;
    image-rendering: -webkit-optimize-contrast;
}

/* Intersection Observer Optimization */
.video-bg[data-observed="true"] {
    /* Mark observed containers */
    contain: layout style paint;
}

/* Blur Placeholder for Instant Background */
.video-bg::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 50%, #f1f5f9 100%);
    z-index: 0;
    opacity: 0.3;
    filter: blur(20px);
    transform: scale(1.1);
    transition: opacity 0.3s ease;
}

.video-bg.loaded::before {
    opacity: 0;
}

/* Dominant Color Backgrounds (Add via inline styles) */
.video-bg[data-dominant-color] {
    background-color: var(--dominant-color, #f1f5f9);
}

/* Critical Resource Hints Support */
.video-bg.priority-0 .video-poster {
    /* Hero poster gets resource hints */
    image-rendering: -webkit-optimize-contrast;
    image-rendering: optimize-contrast;
    content-visibility: visible;
}

/* Smooth Aspect Ratio Maintenance */
.video-bg.aspect-video {
    aspect-ratio: 16 / 9;
    contain: layout style paint;
}

.video-bg.aspect-square {
    aspect-ratio: 1 / 1;
    contain: layout style paint;
}

.video-bg.aspect-portrait {
    aspect-ratio: 9 / 16;
    contain: layout style paint;
}

/* Ultra-smooth transitions for premium feel */
.video-poster,
.lazy-video {
    transition-timing-function: cubic-bezier(0.4, 0.0, 0.2, 1);
    transition-property: opacity, transform, filter;
}

/* Prevent layout shifts during loading */
.video-bg {
    min-height: 200px; /* Adjust based on your design */
    background-color: #f8fafc;
}

/* Loading indicator for slow connections */
.video-bg.loading::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 20px;
    height: 20px;
    margin: -10px 0 0 -10px;
    border: 2px solid rgba(59, 130, 246, 0.3);
    border-top-color: rgba(59, 130, 246, 1);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    z-index: 3;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.video-bg.loaded::after {
    display: none;
}
